[
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "07b598d0-9298-11ee-ad23-03bc06d9e1ae",
    "configuration": "{\"executionPriority\":25,\"state\":\"enabled\",\"spec\":{\"trigger\":{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-pre-create\"},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/insights/query\",\"arguments\":{\"insightType\":\"aiops.ibm.com/insight-type/similar-incidents\",\"serviceUrl\":{\"$template\":\"{{ services.similarIncidents.url }}/v2/similar_incidents/search\"},\"insightId\":{\"$variable\":\"story.id\"},\"parameters\":{\"story_id\":{\"$variable\":\"story.id\"},\"text\":{\"$variable\":\"story.title\"},\"application_group_id\":\"1000\",\"application_id\":\"1000\"}},\"output\":\"proposedInsight\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if we have a valid insight\",\"condition\":\"{{ exists proposedInsight }}\",\"then\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"$variable\":\"proposedInsight\"}},\"output\":\"story.insights.[]\"}]}}]},\"hash\":\"45b71aecc9ae42ddc927a574c2b46edac1a1e898\",\"revision\":\"87c01d272ed36438304860ab58cdc8da5a3086f7\",\"hotfields\":null}",
    "entityid": "story",
    "metadata": "{\"name\":\"DEMO Similar Incident detection for Incidents\",\"description\":\"Created by Nicks scripts\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T11:26:55.708Z\",\"creationTimestamp\":\"2023-12-04T11:26:55.708Z\"}",
    "triggerid": "aiops.ibm.com/trigger/story-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "09338640-9298-11ee-ad23-03bc06d9e1ae",
    "configuration": "{\"executionPriority\":25,\"state\":\"enabled\",\"spec\":{\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}}],\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\"\"}}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Condition set 1\",\"conditions\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"({{alert.state}} == \\"open\\")\"}}]}},\"then\":[{\"actionId\":\"aiops.ibm.com/action/internal/insights/correlate\",\"output\":\"alert.insights.[]\",\"arguments\":{\"correlationKey\":{\"$template\":\"{{alert.resource.application}}\"},\"relationshipType\":\"aiops.ibm.com/insight-type/relationship/causal\",\"relationshipSource\":\"aiops.ibm.com/insight-source/relationship/causal/custom\",\"relationshipDetails\":{\"policyId\":{\"$variable\":\"policy.id\"}},\"window\":{\"durationMS\":240000,\"type\":\"rolling\"}}}]}}]},\"hash\":\"9226bb34887e1a38eaf5299c1d3fe08eaa1da911\",\"revision\":\"258cf1463d5c87ef6b77d5d415163f9b06cb7961\",\"hotfields\":[]}",
    "entityid": "[\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:scopebased\",\"ibm.com/is-default\":\"false\"},\"name\":\"DEMO Scope Grouping\",\"description\":\"Created by Nicks scripts\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T11:26:58.212Z\",\"creationTimestamp\":\"2023-12-04T11:26:58.212Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-pre-create\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "3849c720-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":101,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{}}],\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ alert.state }} == \\"closed\\"\",\"then\":[{\"actionId\":\"aiops/enrichments/updateUnionAlertCount\",\"arguments\":{\"condition\":\"{{insight.type}} == \\"aiops.ibm.com/insight-type/relationship/causal\\"\",\"insights\":{\"$variable\":\"alert.insights\"},\"operation\":\"decrement\",\"source\":\"\"}}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{exists prevAlert}}\",\"then\":[{\"actionId\":\"aiops/enrichments/checkUnionUpdateRequired\",\"arguments\":{\"currentInsights\":{\"$variable\":\"alert.insights\"},\"prevInsights\":{\"$variable\":\"prevAlert.insights\"},\"condition\":\"{{insight.type}} == \\"aiops.ibm.com/insight-type/relationship/causal\\"\"},\"output\":\"runUnionAction\"}],\"else\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":true},\"output\":\"runUnionAction\"}]}},{\"actionId\":\"aiops.ibm.com/action/internal/conditional\",\"arguments\":{\"name\":\"Check if union action needs to be run\",\"condition\":\"{{ runUnionAction }}\",\"then\":[{\"actionId\":\"aiops/enrichments/union\",\"arguments\":{\"insights\":{\"$variable\":\"alert.insights\"},\"durationMS\":3600000,\"source\":\"\",\"condition\":\"{{insight.type}} == \\"aiops.ibm.com/insight-type/relationship/causal\\"\"},\"output\":\"alert.insights.[]\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ triggerId }} == \\"aiops.ibm.com/trigger/alert-pre-create\\"\",\"then\":[{\"actionId\":\"aiops/enrichments/updateUnionAlertCount\",\"arguments\":{\"condition\":\"{{insight.type}} == \\"aiops.ibm.com/insight-type/relationship/causal\\"\",\"insights\":{\"$variable\":\"alert.insights\"},\"operation\":\"increment\",\"source\":\"\"}}]}}]}}]},\"hash\":\"0c26d4c8c815d4a0e44fe9ce15384445957044d1\",\"revision\":\"57b6e2367272aeccac1153beb4d51cdf8d73993a\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Derive the union of all correlated groups\",\"description\":\"Enriches a causal alert relationship that represents the union of all other causal alert relationships in order to form a super-group\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:23.246Z\",\"creationTimestamp\":\"2023-12-04T10:02:23.246Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-updated\",\"aiops.ibm.com/trigger/alert-pre-create\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "3863ded0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":50,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{\"condition\":\"{{#if (exists alert.sender.name)}} {{ alert.sender.name }} == \\"Log Anomaly\\" and not {{ isEmpty alert.insights }} {{else}} false {{/if}}\"}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/array/foreach\",\"arguments\":{\"array\":{\"$variable\":\"alert.insights\"},\"condition\":\"{{element.type}} == \\"aiops.ibm.com/insight-type/lad/templates\\"\",\"foreach\":[{\"actionId\":\"aiops.ibm.com/action/internal/insights/query\",\"arguments\":{\"insightId\":{\"$variable\":\"alert.id\"},\"insightType\":\"aiops.ibm.com/insight-type/lad/resolutions\",\"serviceUrl\":{\"$template\":\"{{ services.oobRecommendedActions.url }}/v2/oob_recommended_actions/extract_resolution_data/\"},\"parameters\":{\"significant_message_code\":{\"$variable\":\"element.details.significant_message_code\"},\"message_type\":{\"$variable\":\"element.details.type_window\"}}},\"output\":\"alert.insights.[]\"}]}}]},\"hash\":\"b57134e2daa118cdbc0effdd9b688511d8033956\",\"revision\":\"acaa7cdf17ef66a1136d771ae5b4454ca767fbae\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"WebSphere resolution action recommendation policy\",\"description\":\"Queries for recommended resolution actions for WebSphere log anomalies and adds information about them to the alert\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:23.421Z\",\"creationTimestamp\":\"2023-12-04T10:02:23.421Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "388597a0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":50,\"state\":\"enabled\",\"spec\":{\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\"\"}}},\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"$variable\":\"constants.baseTriggerCondition\"},{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{#if (exists alert.resource.scopeId)}} {{#if (exists prevAlert.resource.scopeId)}} {{ prevAlert.resource.scopeId }} != {{ alert.resource.scopeId }} {{else}} true {{/if}} {{else}}false{{/if}}\"}}]}}}}],\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/conditional\",\"arguments\":{\"name\":\"Condition set 1\",\"condition\":\"(not {{isEmpty alert.resource.scopeId}})\",\"then\":[{\"actionId\":\"aiops.ibm.com/action/internal/insights/correlate\",\"output\":\"alert.insights.[]\",\"arguments\":{\"correlationKey\":{\"$template\":\"{{alert.resource.scopeId}}\"},\"relationshipType\":\"aiops.ibm.com/insight-type/relationship/causal\",\"relationshipSource\":\"aiops.ibm.com/insight-source/relationship/causal/custom\",\"relationshipDetails\":{\"policyId\":{\"$variable\":\"policy.id\"}},\"window\":{\"type\":\"rolling\",\"durationMS\":900000}}}]}}]},\"hash\":\"a2e516766c0563d0cfb88e612f2b838ca229ed93\",\"revision\":\"91e79c6e09651e064048322946acfcebcaaf868b\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:scopebased\",\"ibm.com/is-default\":\"true\"},\"name\":\"Default Netcool scope-based grouping - with a rolling window of 15 minutes\",\"description\":\"Providing the ScopeID field in your Netcool system is mapped to the alert.resource.scopeId field in AIOPS this policy will use that value to create scope based groupings\",\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:23.641Z\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"creationTimestamp\":\"2023-12-04T10:02:23.641Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-pre-create\",\"aiops.ibm.com/trigger/alert-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "3888cbf0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":102,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"triggers\":[{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-created\",\"arguments\":{}},{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-updated\",\"arguments\":{}}],\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/persistence/persistupdates\",\"arguments\":{\"variable\":\"story\",\"entityId\":{\"$variable\":\"story.id\"},\"entityType\":\"story\",\"channel\":\"stories-input\"}}]},\"hash\":\"57b6b4c97add1da17afaee48087354d077e17ef2\",\"revision\":\"96b56db2f37f5a2dcbeca61b02fcdada17a17b16\",\"hotfields\":null}",
    "entityid": "[\"story\",\"story\"]",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default story changed persistence policy\",\"description\":\"Persists any derived updates after a story change notification\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:23.663Z\",\"creationTimestamp\":\"2023-12-04T10:02:23.663Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/story-created\",\"aiops.ibm.com/trigger/story-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "388bd930-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":102,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-created\",\"arguments\":{}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{}}],\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/persistence/persistupdates\",\"arguments\":{\"variable\":\"alert\",\"entityId\":{\"$variable\":\"alert.id\"},\"entityType\":\"alert\",\"channel\":\"alerts-input\"}}]},\"hash\":\"b02cf1a67129724465f12c7f4d79160ae1321453\",\"revision\":\"d32628e86bed6c7d543bb99945e34b63e442b909\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default alert changed persistence policy\",\"description\":\"Persists any derived updates after an alert change notification\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:23.683Z\",\"creationTimestamp\":\"2023-12-04T10:02:23.683Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-created\",\"aiops.ibm.com/trigger/alert-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "38968790-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":50,\"state\":\"disabled\",\"spec\":{\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\" and {{alert.suppressed}} == false\"}}},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-created\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Match Golden Signal\",\"conditions\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"({{alert.severity}} >= 5)\"}},{\"actionId\":\"lang/array/some\",\"arguments\":{\"elements\":{\"$variable\":\"alert.insights\"},\"elementVariableName\":\"insight\",\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"({{insight.type}} == \\"aiops.ibm.com/insight-type/golden-signal\\") and ({{insight.details.typeGoldenSignal}} == \\"effect\\")\"}}}}]}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":1,\"title\":{\"$variable\":\"alert.summary\"},\"description\":{\"$variable\":\"alert.summary\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":null,\"team\":null}},\"output\":\"global.proposedStories.[]\"}]}}]},\"hash\":\"10dd47c191fcc6abfad1888212959527fba1fcbe\",\"revision\":\"4c60e27c8312c6c80f88cb4c8d21408bd2d1a420\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:createstory\",\"ibm.com/is-default\":\"true\"},\"name\":\"Golden signal and persistence story creation\",\"description\":\"Proposes a story based on a Major or Critical severity alert that has a golden signal type of effect\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:23.753Z\",\"creationTimestamp\":\"2023-12-04T10:02:23.753Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-created"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "3898f890-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":101,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-pre-delete\",\"arguments\":{}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/persistence/persist\",\"arguments\":{\"entity\":{\"$variable\":\"story\"},\"entityId\":{\"$variable\":\"story.id\"},\"entityType\":\"story\",\"changeType\":\"delete\",\"channel\":\"stories-output\"}}]},\"hash\":\"7bbcf09d0432c12ed4e0c225f344966e95ddcaca\",\"revision\":\"e25b6a3b839937a071b8824cd58ed8e368579249\",\"hotfields\":null}",
    "entityid": "story",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default story-delete persistence policy\",\"description\":\"Persists the story delete to the data store\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:23.768Z\",\"creationTimestamp\":\"2023-12-04T10:02:23.768Z\"}",
    "triggerid": "aiops.ibm.com/trigger/story-pre-delete"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "38a2bc90-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":50,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-updated\",\"arguments\":{}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/stories/notify\",\"arguments\":{\"entity\":{\"$variable\":\"story\"},\"prevEntity\":{\"$variable\":\"prevStory\"},\"type\":\"update\"}},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists story.insights }}\",\"then\":[{\"actionId\":\"lang/array/filter\",\"arguments\":{\"condition\":\"{{ insightData.type }} == \\"aiops.ibm.com/insight-type/chatops/notification\\"\",\"elements\":{\"$variable\":\"story.insights\"},\"elementVariableName\":\"insightData\"},\"output\":\"notificationsData\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ length notificationsData }} > 1\",\"then\":[{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"INFO\",\"message\":\"Found more than one notification insight found on the story (unexpected). Using the first one.\"}}]}},{\"actionId\":\"lang/array/first\",\"arguments\":{\"elements\":{\"$variable\":\"notificationsData\"}},\"output\":\"firstNotificationData\"},{\"actionId\":\"lang/array/filter\",\"arguments\":{\"condition\":\"{{ notification.type }} == \\"connector\\"\",\"elements\":{\"$variable\":\"firstNotificationData.details.notification\"},\"elementVariableName\":\"notification\"},\"output\":\"notificationConnectors\"},{\"actionId\":\"aiops.ibm.com/action/internal/array/foreach\",\"arguments\":{\"array\":{\"$variable\":\"notificationConnectors\"},\"foreach\":[{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ prevStory.state }} != \\"closed\\" and {{ story.state }} == \\"closed\\"\",\"then\":[{\"actionId\":\"aiops/connectors/outbound/invokeAction\",\"arguments\":{\"connectorId\":{\"$variable\":\"element.details.connectorUID\"},\"action\":\"notify_close\",\"arguments\":{\"incident\":{\"$variable\":\"story\"}}}}],\"else\":[{\"actionId\":\"aiops/connectors/outbound/invokeAction\",\"arguments\":{\"connectorId\":{\"$variable\":\"element.details.connectorUID\"},\"action\":\"notify_update\",\"arguments\":{\"incident\":{\"$variable\":\"story\"}}}}]}}],\"condition\":\"true\",\"element\":\"element\"}}]}}]},\"hash\":\"6c418ad8c0754c92370c039efa8c9b9b9c8028d3\",\"revision\":\"c6bd3e117512e73bd25e0345ac1311f3409fcc17\",\"hotfields\":null}",
    "entityid": "story",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default story update notification policy\",\"description\":\"Notifies outbound integrations that a story has been updated\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:23.832Z\",\"creationTimestamp\":\"2023-12-04T10:02:23.832Z\"}",
    "triggerid": "aiops.ibm.com/trigger/story-updated"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "38c11a00-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":110,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-created\",\"arguments\":{}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{}},{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-updated\",\"arguments\":{}}],\"actions\":[{\"actionId\":\"lang/keyBy\",\"arguments\":{\"key\":{\"$template\":\"{{#if story}}{{story.id}}{{else}}{{alert.id}}{{/if}}\"},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Alert create or update\",\"condition\":\"{{ triggerId }} == \\"aiops.ibm.com/trigger/alert-created\\" or {{ triggerId }} == \\"aiops.ibm.com/trigger/alert-updated\\"\n\",\"then\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if we have stories to propose\",\"condition\":\"{{ exists global.proposedStories }}\",\"then\":[{\"actionId\":\"aiops/stories/getProposedStory\",\"arguments\":{\"proposedStories\":{\"$variable\":\"global.proposedStories\"}},\"output\":\"proposedStory\"},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"alertId {{alert.id}} to propose story: {{proposedStory}}\"},\"level\":\"DEBUG\"}}],\"else\":[{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"There is no story to propose with alertId {{alert.id}}\"},\"level\":\"DEBUG\"}}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if we have a new story proposed\",\"condition\":\"{{ exists proposedStory }}\",\"then\":[{\"actionId\":\"aiops/enrichments/correlation/getUnionInsight\",\"arguments\":{\"insights\":{\"$variable\":\"proposedStory.insights\"}},\"output\":\"unionInsight\"},{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":[]},\"output\":\"existingStories\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{exists unionInsight.details.subsumedUnions}}\",\"then\":[{\"actionId\":\"aiops.ibm.com/action/internal/array/foreach\",\"arguments\":{\"array\":{\"$variable\":\"unionInsight.details.subsumedUnions\"},\"foreach\":[{\"actionId\":\"lang/keyBy\",\"arguments\":{\"key\":{\"$variable\":\"element\"},\"actions\":[{\"actionId\":\"aiops/stories/getExistingStoriesByUnionId\",\"arguments\":{\"unionId\":{\"$variable\":\"element\"}},\"output\":\"existingStoriesFromSubsumedGroups\"},{\"actionId\":\"aiops/stories/clearExistingStoriesByUnionId\",\"arguments\":{\"unionId\":{\"$variable\":\"element\"}}},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{exists existingStoriesFromSubsumedGroups}}\",\"then\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"$variable\":\"existingStoriesFromSubsumedGroups\"}},\"output\":\"existingStories.[]\"}]}}]}}]}}]}},{\"actionId\":\"lang/keyBy\",\"arguments\":{\"key\":{\"$variable\":\"unionInsight.id\"},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/array/foreach\",\"arguments\":{\"array\":{\"$variable\":\"existingStories\"},\"foreach\":[{\"actionId\":\"aiops/stories/moveStoryToNewGroup\",\"arguments\":{\"story\":{\"$variable\":\"element\"},\"newUnion\":{\"$variable\":\"unionInsight\"}},\"output\":\"storyUnionIdUpdate\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{exists storyUnionIdUpdate}}\",\"then\":[{\"actionId\":\"aiops/io/sendChangeRequest\",\"arguments\":{\"entityId\":{\"$variable\":\"storyUnionIdUpdate.id\"},\"changeType\":\"update\",\"entityType\":\"story\",\"channel\":\"stories-input\",\"entity\":{\"$variable\":\"storyUnionIdUpdate\"}}}]}}]}},{\"actionId\":\"aiops/stories/getExistingStoriesByUnionId\",\"arguments\":{\"unionId\":{\"$variable\":\"unionInsight.id\"}},\"output\":\"existingStories\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ length existingStories }} > 0\",\"then\":[{\"actionId\":\"aiops/stories/getEarliestOpenStory\",\"arguments\":{\"stories\":{\"$variable\":\"existingStories\"}},\"output\":\"earliestOpenStory\"},{\"actionId\":\"aiops/stories/addTriggerAlertToStory\",\"arguments\":{\"alertId\":{\"$variable\":\"alert.id\"},\"alertState\":{\"$variable\":\"alert.state\"},\"story\":{\"$variable\":\"earliestOpenStory\"}},\"output\":\"storyUpdateAlertIds\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{exists storyUpdateAlertIds}}\",\"then\":[{\"actionId\":\"aiops/io/sendChangeRequest\",\"arguments\":{\"entityId\":{\"$variable\":\"storyUpdateAlertIds.id\"},\"changeType\":\"update\",\"entityType\":\"story\",\"channel\":\"stories-input\",\"entity\":{\"$variable\":\"storyUpdateAlertIds\"}}}]}}],\"else\":[{\"actionId\":\"aiops/stories/getHoldoffDelay\",\"arguments\":{\"insights\":{\"$variable\":\"proposedStory.insights\"}},\"output\":\"creationDelayMs\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{creationDelayMs}} > 0\",\"then\":[{\"actionId\":\"lang/state/read\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\"},\"output\":\"delayedStory\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{exists delayedStory}}\",\"then\":[{\"actionId\":\"aiops/stories/updateProposedStoryAlertIds\",\"arguments\":{\"alertId\":{\"$variable\":\"alert.id\"},\"alertState\":{\"$variable\":\"alert.state\"},\"proposedStory\":{\"$variable\":\"delayedStory\"}},\"output\":\"updatedProposedStory\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists updatedProposedStory }}\",\"then\":[{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\",\"value\":{\"$variable\":\"updatedProposedStory\"}}}],\"else\":[{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"DEBUG\",\"message\":{\"$template\":\"Deleting delayed proposed story for alertId: {{alert.id}}. There are no associated alerts remaining.\"}}},{\"actionId\":\"lang/state/delete\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\"}}]}}],\"else\":[{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\",\"value\":{\"$variable\":\"proposedStory\"}}},{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"INFO\",\"message\":{\"$template\":\"Delaying creation of story {{ proposedStory }} by {{ creationDelayMs }} ms.\"}}},{\"actionId\":\"lang/scheduleAction\",\"arguments\":{\"delayTimeMs\":{\"$variable\":\"creationDelayMs\"},\"actions\":[{\"actionId\":\"lang/actionsList\",\"arguments\":{\"actions\":[{\"actionId\":\"lang/state/read\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\"},\"output\":\"delayedStory\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists delayedStory }}\",\"then\":[{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"INFO\",\"message\":{\"$template\":\"Resuming creation of story {{ delayedStory }} after delay.\"}}},{\"actionId\":\"lang/state/delete\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\"}},{\"actionId\":\"aiops/stories/saveNewStory\",\"arguments\":{\"story\":{\"$variable\":\"delayedStory\"}}},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Sending ChangeRequest for the delayedStory {{delayedStory}}.\"},\"level\":\"INFO\"}},{\"actionId\":\"aiops/io/sendChangeRequest\",\"arguments\":{\"entityId\":{\"$variable\":\"delayedStory.id\"},\"changeType\":\"create\",\"entityType\":\"story\",\"channel\":\"stories-input\",\"entity\":{\"$variable\":\"delayedStory\"}}}],\"else\":[{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"INFO\",\"message\":\"A delayed story has been deleted before creation.\"}}]}}]}}]}}]}}],\"else\":[{\"actionId\":\"lang/log\",\"arguments\":{\"message\":\"Check if we have a previous delayed story. if we do update it and send it now\",\"level\":\"INFO\"}},{\"actionId\":\"lang/state/read\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\"},\"output\":\"delayedStory\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{exists delayedStory}}\",\"then\":[{\"actionId\":\"aiops/stories/updateProposedStoryAlertIds\",\"arguments\":{\"alertId\":{\"$variable\":\"alert.id\"},\"alertState\":{\"$variable\":\"alert.state\"},\"proposedStory\":{\"$variable\":\"delayedStory\"}},\"output\":\"updatedProposedStory\"},{\"actionId\":\"lang/state/delete\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\"}},{\"actionId\":\"aiops/stories/saveNewStory\",\"arguments\":{\"story\":{\"$variable\":\"updatedProposedStory\"}}},{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"INFO\",\"message\":{\"$template\":\"Sending the delayedStory immediately: {{delayedStory}}\"}}},{\"actionId\":\"aiops/io/sendChangeRequest\",\"arguments\":{\"entityId\":{\"$variable\":\"updatedProposedStory.id\"},\"changeType\":\"create\",\"entityType\":\"story\",\"channel\":\"stories-input\",\"entity\":{\"$variable\":\"updatedProposedStory\"}}}],\"else\":[{\"actionId\":\"aiops/stories/saveNewStory\",\"arguments\":{\"story\":{\"$variable\":\"proposedStory\"}}},{\"actionId\":\"aiops/io/sendChangeRequest\",\"arguments\":{\"entityId\":{\"$variable\":\"proposedStory.id\"},\"changeType\":\"create\",\"entityType\":\"story\",\"channel\":\"stories-input\",\"entity\":{\"$variable\":\"proposedStory\"}}}]}}]}}]}}]}}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ triggerId }} == \\"aiops.ibm.com/trigger/alert-updated\\" and {{ prevAlert.state }} != {{ alert.state }}\n\",\"then\":[{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"DEBUG\",\"message\":{\"$template\":\"Alert {{alert}} state has been updated. We may need to update the associated stories.\"}}},{\"actionId\":\"aiops/enrichments/correlation/getUnionInsight\",\"arguments\":{\"insights\":{\"$variable\":\"alert.insights\"}},\"output\":\"unionInsight\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists unionInsight }}\",\"then\":[{\"actionId\":\"lang/keyBy\",\"arguments\":{\"key\":{\"$variable\":\"unionInsight.id\"},\"actions\":[{\"actionId\":\"lang/state/read\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\"},\"output\":\"delayedStory\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists delayedStory }}\",\"then\":[{\"actionId\":\"aiops/stories/updateProposedStoryAlertIds\",\"arguments\":{\"alertId\":{\"$variable\":\"alert.id\"},\"alertState\":{\"$variable\":\"alert.state\"},\"proposedStory\":{\"$variable\":\"delayedStory\"}},\"output\":\"updatedProposedStory\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists updatedProposedStory }}\",\"then\":[{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"DEBUG\",\"message\":{\"$template\":\"We keep delayed alert: {{alert.id}}. Updated proposed story is: {{updatedProposedStory}}.\"}}},{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\",\"value\":{\"$variable\":\"updatedProposedStory\"}}}],\"else\":[{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"DEBUG\",\"message\":{\"$template\":\"Deleting delayed proposed story for alertId: {{alert.id}}. There are no associated alerts remaining.\"}}},{\"actionId\":\"lang/state/delete\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"delayed/story\"}}]}}]}}]}}]}}]}}],\"else\":[{\"actionId\":\"aiops/enrichments/correlation/getUnionInsight\",\"arguments\":{\"insights\":{\"$variable\":\"story.insights\"}},\"output\":\"unionInsight\"},{\"actionId\":\"lang/keyBy\",\"arguments\":{\"key\":{\"$variable\":\"unionInsight.id\"},\"actions\":[{\"actionId\":\"aiops/stories/handleExternalStoryUpdate\",\"arguments\":{\"unionId\":{\"$variable\":\"unionInsight.id\"},\"story\":{\"$variable\":\"story\"},\"prevStory\":{\"$variable\":\"prevStory\"}}}]}},{\"actionId\":\"aiops/enrichments/correlation/getUnionInsight\",\"arguments\":{\"insights\":{\"$variable\":\"prevStory.insights\"}},\"output\":\"prevUnionInsight\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ prevUnionInsight.id }} != {{ unionInsight.id }}\",\"then\":[{\"actionId\":\"lang/keyBy\",\"arguments\":{\"key\":{\"$variable\":\"prevUnionInsight.id\"},\"actions\":[{\"actionId\":\"aiops/stories/clearExistingStoriesByUnionId\",\"arguments\":{\"unionId\":{\"$variable\":\"prevUnionInsight.id\"}}}]}}]}}]}}]}}]},\"hash\":\"e4cbb91e277ed65f9bb7840be11017ac5f4fb5ec\",\"revision\":\"91cacf27ed1d0e501c052dc7658517b2a8f74f4f\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\",\"story\"]",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"System story creation\",\"description\":\"Creates or updates a single story based on the stories proposed by other policies\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:23.937Z\",\"creationTimestamp\":\"2023-12-04T10:02:23.937Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-created\",\"aiops.ibm.com/trigger/alert-updated\",\"aiops.ibm.com/trigger/story-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "38c538b0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":50,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-created\",\"arguments\":{}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/stories/notify\",\"arguments\":{\"entity\":{\"$variable\":\"story\"},\"type\":\"create\"}},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists story.insights }}\",\"then\":[{\"actionId\":\"lang/array/filter\",\"arguments\":{\"condition\":\"{{ insightData.type }} == \\"aiops.ibm.com/insight-type/chatops/notification\\"\",\"elements\":{\"$variable\":\"story.insights\"},\"elementVariableName\":\"insightData\"},\"output\":\"notificationsData\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ length notificationsData }} > 1\",\"then\":[{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"INFO\",\"message\":\"Found more than one notification insight found on the story (unexpected). Using the first one.\"}}]}},{\"actionId\":\"lang/array/first\",\"arguments\":{\"elements\":{\"$variable\":\"notificationsData\"}},\"output\":\"firstNotificationData\"},{\"actionId\":\"lang/array/filter\",\"arguments\":{\"condition\":\"{{ notification.type }} == \\"connector\\"\",\"elements\":{\"$variable\":\"firstNotificationData.details.notification\"},\"elementVariableName\":\"notification\"},\"output\":\"notificationConnectors\"},{\"actionId\":\"aiops.ibm.com/action/internal/array/foreach\",\"arguments\":{\"array\":{\"$variable\":\"notificationConnectors\"},\"foreach\":[{\"actionId\":\"aiops/connectors/outbound/invokeAction\",\"arguments\":{\"connectorId\":{\"$variable\":\"element.details.connectorUID\"},\"action\":\"notify_create\",\"arguments\":{\"incident\":{\"$variable\":\"story\"}}}}],\"condition\":\"true\",\"element\":\"element\"}}]}}]},\"hash\":\"af0068a07921b81545c8c8a6b36552c46a7c05db\",\"revision\":\"8d5a7ebab47a8d2a633f5e429fa811276f17d545\",\"hotfields\":null}",
    "entityid": "story",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default story create notification policy\",\"description\":\"Notifies outbound integrations that a story has been created\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.059Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.059Z\"}",
    "triggerid": "aiops.ibm.com/trigger/story-created"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "38d146a0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":-2,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{\"condition\":\"not {{ isEmpty alert.resource }}\"}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":\"not {{ isEmpty alert.resource }}\"}}],\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Check resource topology and prevAlert.\",\"condition\":\"{{#if (exists prevAlert)}} {{ prevAlert.resource }} != {{ alert.resource }} {{else}} true {{/if}}\",\"then\":[{\"actionId\":\"aiops/enrichments/topology/query\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"}},\"output\":\"alert.insights.[]\"}],\"else\":[{\"actionId\":\"aiops/io/sendMessage\",\"arguments\":{\"entityType\":\"alert\",\"channel\":\"topology-requests\",\"entity\":{\"$variable\":\"alert\"}}}]}}]},\"hash\":\"0d44501d6596dd7b73b30a5032b5567e500293bf\",\"revision\":\"17b31ed3933c3c48f69e746a6aaea6fe75bc9317\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default topology enrichment policy\",\"description\":\"Queries the topology for the resource referenced by an alert and enriches resource, resource group and application information into the alert.\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.138Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.138Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-pre-create\",\"aiops.ibm.com/trigger/alert-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "38d47af0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":101,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-delete\",\"arguments\":{}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/persistence/persist\",\"arguments\":{\"entityId\":{\"$variable\":\"alert.id\"},\"entityType\":\"alert\",\"changeType\":\"delete\",\"channel\":\"alerts-output\"}}]},\"hash\":\"4f3ba81da00dc59cb511c69cd9c30cb41c78a650\",\"revision\":\"c42e37beb95ae9146e941fe93c7d9c63ae600b6f\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default alert-delete persistence policy\",\"description\":\"Persists alert deletions to the data store\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.159Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.159Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-pre-delete"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "38e14c30-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":-3,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{}},\"actions\":[{\"actionId\":\"lang/keyBy\",\"arguments\":{\"key\":{\"$variable\":\"alert.id\"},\"actions\":[{\"actionId\":\"aiops/alerts/setDefaultProperties\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"defaults\":{\"expirySeconds\":0,\"suppressed\":false,\"acknowledged\":false,\"team\":\"-\",\"owner\":\"-\",\"signature\":\"-\",\"insights\":[]}},\"output\":\"alert\"}]}}]},\"hash\":\"6c2cb1541730b732b25b5cc64fce1c66d25713d4\",\"revision\":\"1a0e4e519f798fbcea5a93c5de3a87d082372401\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default set alert properties policy\",\"description\":\"Set default values for alerts if not provided by the user\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.243Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.243Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "38e45970-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":-1,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"conditions\":{\"actionId\":\"lang/array/every\",\"arguments\":{\"elements\":{\"$variable\":\"alert.insights\"},\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{element.type}} != \\"aiops.ibm.com/insight-type/golden-signal\\"\"}}}},\"then\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":true},\"output\":\"gsInsightNotPresent\"}],\"else\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":false},\"output\":\"gsInsightNotPresent\"}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"conditions\":{\"actionId\":\"lang/array/some\",\"arguments\":{\"elements\":{\"$variable\":\"alert.insights\"},\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{element.type}} == \\"aiops.ibm.com/insight-type/verbose-description\\"\"}}}},\"then\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":true},\"output\":\"ladGsInsightObjectPresent\"}],\"else\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":false},\"output\":\"ladGsInsightObjectPresent\"}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.sender.name}} == \\"Log Anomaly\\"\"}},\"then\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":true},\"output\":\"ladAlert\"}],\"else\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":false},\"output\":\"ladAlert\"}]}},{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"DEBUG\",\"message\":{\"$template\":\"gsInsightNotPresent:  {{ gsInsightNotPresent }} ladGsInsightObjectPresent:  {{ladGsInsightObjectPresent}} ladAlert: {{ladAlert}}\"}}},{\"actionId\":\"lang/if\",\"arguments\":{\"conditions\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{gsInsightNotPresent}} == true\"}},{\"actionId\":\"lang/condition/or\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ladAlert}} == false\"}},{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"not {{isEmpty alert.type.classification}}\"}}]}},{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ladAlert}} == true\"}},{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ladGsInsightObjectPresent}} == true\"}}]}}]}}]}},\"then\":[{\"actionId\":\"lang/if\",\"arguments\":{\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ladAlert}} == true\"}},\"then\":[{\"actionId\":\"lang/array/filter\",\"arguments\":{\"condition\":\"{{ insight.type }} == \\"aiops.ibm.com/insight-type/verbose-description\\"\",\"elements\":{\"$variable\":\"alert.insights\"},\"elementVariableName\":\"insight\"},\"output\":\"ladGSInsightArray\"},{\"actionId\":\"lang/array/first\",\"arguments\":{\"elements\":{\"$variable\":\"ladGSInsightArray\"}},\"output\":\"ladGSInsight\"},{\"actionId\":\"aiops/enrichments/goldensignal/classify\",\"arguments\":{\"insightType\":\"aiops.ibm.com/insight-type/golden-signal\",\"insightId\":{\"$variable\":\"alert.id\"},\"input\":{\"$variable\":\"ladGSInsight.details.verboseDescription\"}},\"output\":\"alert.insights.[]\"},{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"DEBUG\",\"message\":{\"$template\":\"gs classifier ran with input as ladGSInsight.details.verboseDescription: {{ladGSInsight.details.verboseDescription}}\"}}}],\"else\":[{\"actionId\":\"aiops/enrichments/goldensignal/classify\",\"arguments\":{\"insightType\":\"aiops.ibm.com/insight-type/golden-signal\",\"insightId\":{\"$variable\":\"alert.id\"},\"input\":{\"$variable\":\"alert.type.classification\"}},\"output\":\"alert.insights.[]\"},{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"DEBUG\",\"message\":{\"$template\":\"gs classifier ran with input as alert.type.classification: {{alert.type.classification}}\"}}}]}}],\"else\":[{\"actionId\":\"lang/log\",\"arguments\":{\"level\":\"DEBUG\",\"message\":{\"$template\":\"GS is already present\"}}}]}}]},\"hash\":\"65da5afe70e0965a15dec6e305a5fc6872e2fa28\",\"revision\":\"cee97fd14cc40e9fffd31dba3c9e340ee120afb2\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Alert golden signal prediction policy\",\"description\":\"Classifier for golden signal prediction action on alert data that adds golden signal label information to the alert\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.262Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.262Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "38ef2ee0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":102,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/persistence/persist\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"entityId\":{\"$variable\":\"alert.id\"},\"entityType\":\"alert\",\"changeType\":\"create\",\"channel\":\"alerts-output\"}}]},\"hash\":\"0711f66324fb0b7ba22c7df4b50212326d74f9d5\",\"revision\":\"d6e64ccbdd2447e252952cec842063d9de967653\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default alert-create persistence policy\",\"description\":\"Persists the alert to the data store\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.333Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.333Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "3900bb10-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":101,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-pre-create\",\"arguments\":{}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/persistence/persist\",\"arguments\":{\"entity\":{\"$variable\":\"story\"},\"entityId\":{\"$variable\":\"story.id\"},\"entityType\":\"story\",\"changeType\":\"create\",\"channel\":\"stories-output\"}}]},\"hash\":\"365b9d64cf73b52126737bb961e3ac38008885b5\",\"revision\":\"d27b39bfe7d262b92f22f444b24314c5bd37119f\",\"hotfields\":null}",
    "entityid": "story",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default story-create persistence policy\",\"description\":\"Persists the story create to the data store\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.448Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.448Z\"}",
    "triggerid": "aiops.ibm.com/trigger/story-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "3903c850-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":-1,\"state\":\"enabled\",\"spec\":{\"constants\":{\"topologyGroupInsightCondition\":\"{{element.type}} == \\"aiops.ibm.com/insight-type/topology/group\\"\"},\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{\"condition\":\"not {{ isEmpty alert.insights }}\"}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":\"not {{ isEmpty alert.insights }} and {{ length prevAlert.insights }} != {{ length alert.insights }}\"}}],\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/array/filter\",\"arguments\":{\"condition\":{\"$variable\":\"constants.topologyGroupInsightCondition\"},\"elements\":{\"$variable\":\"alert.insights\"}},\"output\":\"groupInsights\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists prevAlert }}\",\"then\":[{\"actionId\":\"aiops.ibm.com/action/internal/array/filter\",\"arguments\":{\"condition\":{\"$variable\":\"constants.topologyGroupInsightCondition\"},\"elements\":{\"$variable\":\"prevAlert.insights\"}},\"output\":\"prevGroupInsights\"},{\"actionId\":\"aiops.ibm.com/action/internal/eval\",\"arguments\":{\"input\":[]},\"output\":\"groupsToCorrelate\"},{\"actionId\":\"aiops.ibm.com/action/internal/array/foreach\",\"arguments\":{\"array\":{\"$variable\":\"groupInsights\"},\"foreach\":[{\"actionId\":\"aiops.ibm.com/action/internal/eval\",\"arguments\":{\"input\":{\"$variable\":\"element\"}},\"output\":\"currentGroupInsight\"},{\"actionId\":\"lang/array/some\",\"arguments\":{\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ currentGroupInsight.id }} == {{ prevGroupInsight.id }}\"}},\"elements\":{\"$variable\":\"prevGroupInsights\"},\"elementVariableName\":\"prevGroupInsight\"},\"output\":\"isExistingInsight\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"not {{ isExistingInsight }}\",\"then\":[{\"actionId\":\"aiops.ibm.com/action/internal/eval\",\"arguments\":{\"input\":{\"$variable\":\"currentGroupInsight\"}},\"output\":\"groupsToCorrelate.[]\"}]}}]}}],\"else\":[{\"actionId\":\"aiops.ibm.com/action/internal/eval\",\"arguments\":{\"input\":{\"$variable\":\"groupInsights\"}},\"output\":\"groupsToCorrelate\"}]}},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Correlating on topology groups {{ groupsToCorrelate }})\"},\"level\":\"INFO\"}},{\"actionId\":\"aiops.ibm.com/action/internal/array/foreach\",\"arguments\":{\"array\":{\"$variable\":\"groupsToCorrelate\"},\"foreach\":[{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Correlating on topology group {{ element }})\"},\"level\":\"INFO\"}},{\"actionId\":\"aiops.ibm.com/action/internal/insights/correlate\",\"arguments\":{\"correlationKey\":{\"$variable\":\"element.id\"},\"relationshipType\":\"aiops.ibm.com/insight-type/relationship/causal\",\"relationshipSource\":\"aiops.ibm.com/insight-source/relationship/causal/topological-group\",\"relationshipDetails\":{\"policyId\":{\"$variable\":\"policy.id\"},\"name\":{\"$variable\":\"element.details.name\"}},\"window\":{\"type\":\"rolling\",\"durationMS\":900000}},\"output\":\"alert.insights.[]\"}]}}]},\"hash\":\"4067ca99463d04a8e5c77f6f1a9744040c585675\",\"revision\":\"b1434eee578fb0d3605ea4bcc4b5b6a3251cbc51\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default topology correlation policy\",\"description\":\"Enriches causal alert relationships based on common resource and application group membership\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.469Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.469Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-pre-create\",\"aiops.ibm.com/trigger/alert-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "390f6110-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":80,\"state\":\"enabled\",\"spec\":{\"constants\":{\"triggerCondition\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ alert.insights }} != \\"undefined\\"\"}},{\"actionId\":\"lang/array/some\",\"arguments\":{\"elements\":{\"$variable\":\"alert.insights\"},\"elementVariableName\":\"insight\",\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"({{ insight.type }} == \\"aiops.ibm.com/insight-type/lad/templates\\")\"}}}}]}}},\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-update\",\"arguments\":{\"condition\":{\"$variable\":\"constants.triggerCondition\"}}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{\"condition\":{\"$variable\":\"constants.triggerCondition\"}}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ alert.state }} == \\"closed\\" and {{ prevAlert.state }} != \\"closed\\"\"}},{\"$variable\":\"constants.triggerCondition\"}]}}}}],\"actions\":[{\"actionId\":\"lang/keyBy\",\"arguments\":{\"key\":{\"$variable\":\"alert.id\"},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ triggerId }} == \\"aiops.ibm.com/trigger/alert-updated\\"\"}},\"then\":[{\"actionId\":\"lang/state/delete\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":\"aiops/enrichments/lad/aggregateCountVectors/aggregate\"}}],\"else\":[{\"actionId\":\"aiops.ibm.com/action/internal/array/foreach\",\"arguments\":{\"array\":{\"$variable\":\"alert.insights\"},\"condition\":\"{{element.type}} == \\"aiops.ibm.com/insight-type/lad/templates\\"\",\"foreach\":[{\"actionId\":\"aiops/enrichments/lad/aggregateCountVectors\",\"arguments\":{\"aggregationKey\":{\"$variable\":\"alert.id\"},\"insightDetails\":{\"$variable\":\"element.details\"},\"insightType\":{\"$variable\":\"element.type\"},\"insightId\":{\"$variable\":\"element.id\"}},\"output\":\"alert.insights.[@id=insight-lad]\"}]}}]}}]}}]},\"hash\":\"ae28cddcae90c8f017a56b95e5b8a2323173d8df\",\"revision\":\"be8ede51a64f115a8dee7e35d61fd59a285df597\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Aggregate log anomaly detection count vectors\",\"description\":\"Aggregates the log message count vectors output by log anomaly events, across the event occurences contributing to a given alert.\n\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.543Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.543Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-pre-update\",\"aiops.ibm.com/trigger/alert-pre-create\",\"aiops.ibm.com/trigger/alert-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "392029f0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":50,\"state\":\"disabled\",\"spec\":{\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\" and {{alert.suppressed}} == false\"}}},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-created\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Match high priority alerts\",\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ alert.severity }} >= 5\"}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":1,\"title\":{\"$variable\":\"alert.summary\"},\"description\":{\"$variable\":\"alert.summary\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":null,\"team\":null}},\"output\":\"global.proposedStories.[]\"}]}}]},\"hash\":\"628dc8b2e5d1335026c1a3bb89213c61f3b03065\",\"revision\":\"581084469dce9c477201463266ebbb8c8bb210dd\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:createstory\",\"ibm.com/is-default\":\"true\"},\"name\":\"Default story creation policy for high severity alerts\",\"description\":\"Proposes a story based on a Major or Critical severity alert\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.655Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.655Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-created"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "39224cd0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":-1,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{\"condition\":\"not {{ isEmpty alert.insights }}\"}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":\"not {{ isEmpty alert.insights }}\"}}],\"actions\":[{\"actionId\":\"lang/array/filter\",\"arguments\":{\"condition\":\"{{ exists element.details.businessCriticality }}\n\",\"elements\":{\"$variable\":\"alert.insights\"}},\"output\":\"topologyInsights\"},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ length topologyInsights }} > 0\",\"then\":[{\"actionId\":\"aiops/enrichments/topology/resolveCriticality\",\"arguments\":{\"insights\":{\"$variable\":\"topologyInsights\"},\"asmBusinessCriticalityAPIUrl\":{\"$template\":\"{{ services.asm.url }}/1.0/topology/metadata?_field=*&_type=WAIOPS_BUSINESS_CRITICALITY&_include_count=false\"},\"asmUsernameFile\":{\"$template\":\"{{ services.asm.usernameFile }}\"},\"asmPasswordFile\":{\"$template\":\"{{ services.asm.passwordFile }}\"}},\"output\":\"alert.insights.[]\"}]}}]},\"hash\":\"50ab4617cb1f07a5f16181adf88ec4be59a92792\",\"revision\":\"38e4530c49463428bca616e3884acc6b46a996e2\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Business criticality enrichment policy\",\"description\":\"Queries to ASM API to get business criticality value for string label in the insight and update a insight of alert\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.669Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.669Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-pre-create\",\"aiops.ibm.com/trigger/alert-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "392d9770-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":101,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"triggers\":[{\"entityId\":\"event\",\"triggerId\":\"aiops.ibm.com/trigger/event-received\",\"arguments\":{}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ prevAlert.state }} != {{ alert.state }}\n\"}}}}],\"actions\":[{\"actionId\":\"lang/keyBy\",\"arguments\":{\"key\":{\"$template\":\"{{#if alert}}{{alert.deduplicationKey}}{{else}}{{event.deduplicationKey}}{{/if}}\"},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists alert }}\",\"then\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"$template\":\"alert/state/problem/{{alert.deduplicationKey}}\"}},\"output\":\"stateId\"},{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"$template\":\"alert/state/resolution/{{alert.deduplicationKey}}\"}},\"output\":\"lastResolutionStateId\"},{\"actionId\":\"lang/state/read\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"stateId\"}},\"output\":\"retrievedAlert\"},{\"actionId\":\"lang/state/read\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"lastResolutionStateId\"}},\"output\":\"retrievedLastResolutionEvent\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if a saved state exists for that al\",\"condition\":\"{{ exists retrievedAlert }}\",\"then\":[{\"actionId\":\"aiops/alerts/updateAlert\",\"arguments\":{\"alertState\":{\"$variable\":\"retrievedAlert\"},\"prevAlert\":{\"$variable\":\"prevAlert\"},\"alert\":{\"$variable\":\"alert\"}},\"output\":\"proposedAlertState\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if there is a proposed alert state\",\"condition\":\"{{ exists proposedAlertState }}\",\"then\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if the state of the proposed alert \",\"condition\":\"{{ proposedAlertState.state }} == \\"closed\\"\",\"then\":[{\"actionId\":\"lang/state/delete\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"stateId\"}}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if the retrievedLastResolutionEvent\",\"condition\":\"{{ exists retrievedLastResolutionEvent }}\",\"then\":[{\"actionId\":\"lang/state/delete\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"lastResolutionStateId\"}}}]}}]}}],\"else\":[{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"stateId\"},\"ttl\":{\"$variable\":\"alertTtl\"},\"value\":{\"$variable\":\"proposedAlertState\"}}}]}}]}}],\"else\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"$template\":\"alert/state/problem/{{event.deduplicationKey}}\"}},\"output\":\"stateId\"},{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"$template\":\"alert/state/resolution/{{event.deduplicationKey}}\"}},\"output\":\"lastResolutionStateId\"},{\"actionId\":\"lang/state/read\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"stateId\"}},\"output\":\"retrievedAlert\"},{\"actionId\":\"lang/state/read\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"lastResolutionStateId\"}},\"output\":\"retrievedLastResolutionEvent\"},{\"actionId\":\"lang/state/buildTtl\",\"arguments\":{\"retentionMs\":2592000000},\"output\":\"alertTtl\"},{\"actionId\":\"lang/state/buildTtl\",\"arguments\":{\"retentionMs\":120000},\"output\":\"resolutionTtl\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if a state exists for that event\",\"condition\":\"{{ exists retrievedAlert }}\",\"then\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":\"update\"},\"output\":\"changeType\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if this is a problem event\",\"condition\":\"{{ event.type.eventType }} == \\"problem\\"\",\"then\":[{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Problem event {{event}} to update alert in saved state.\"},\"level\":\"DEBUG\"}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if there is a saved resolution even\",\"condition\":\"{{ exists retrievedLastResolutionEvent }}\",\"then\":[{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"There is a saved resolution event {{retrievedLastResolutionEvent}} in state for event {{event}}\"},\"level\":\"DEBUG\"}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if saved resolution event occurrenc\",\"condition\":\"{{ exists retrievedLastResolutionEvent.occurrenceTime }}\",\"then\":[{\"actionId\":\"lang/time/isLaterThan\",\"arguments\":{\"timeA\":{\"$variable\":\"event.occurrenceTime\"},\"timeB\":{\"$variable\":\"retrievedLastResolutionEvent.occurrenceTime\"}},\"output\":\"isAfterResolutionTime\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if the problem event is after the s\",\"condition\":\"{{ isAfterResolutionTime }} == true\",\"then\":[{\"actionId\":\"lang/state/delete\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"lastResolutionStateId\"}}},{\"actionId\":\"aiops/alerts/updateFromEvent\",\"arguments\":{\"deduplicationKey\":{\"$variable\":\"event.deduplicationKey\"},\"entity\":{\"$variable\":\"event\"},\"state\":{\"$variable\":\"retrievedAlert\"},\"eventType\":{\"$variable\":\"event.type.eventType\"}},\"output\":\"proposedAlert\"},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Problem event {{event}} occurred after saved resolution event {{retrievedLastResolutionEvent}}.\"},\"level\":\"DEBUG\"}},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Problem event {{event}} proposing alert update: {{proposedAlert}}\"},\"level\":\"DEBUG\"}}],\"else\":[{\"actionId\":\"aiops/alerts/updateEventCountFromEvent\",\"arguments\":{\"deduplicationKey\":{\"$variable\":\"event.deduplicationKey\"},\"entity\":{\"$variable\":\"event\"},\"state\":{\"$variable\":\"retrievedAlert\"},\"eventType\":{\"$variable\":\"event.type.eventType\"}},\"output\":\"proposedAlert\"},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Problem event {{event}} occurred before saved resolution event {{retrievedLastResolutionEvent}}.\"},\"level\":\"DEBUG\"}},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Problem event {{event}} proposing alert update: {{proposedAlert}}\"},\"level\":\"DEBUG\"}}]}}]}}],\"else\":[{\"actionId\":\"aiops/alerts/updateFromEvent\",\"arguments\":{\"deduplicationKey\":{\"$variable\":\"event.deduplicationKey\"},\"entity\":{\"$variable\":\"event\"},\"state\":{\"$variable\":\"retrievedAlert\"},\"eventType\":{\"$variable\":\"event.type.eventType\"}},\"output\":\"proposedAlert\"},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"No saved resolution in state. Problem event {{event}} proposing alert update: {{proposedAlert}}\"},\"level\":\"DEBUG\"}}]}}],\"else\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if there is a saved resolution even\",\"condition\":\"{{ exists retrievedLastResolutionEvent }}\",\"then\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if saved resolution event occurrenc\",\"condition\":\"{{ exists retrievedLastResolutionEvent.occurrenceTime }}\",\"then\":[{\"actionId\":\"lang/time/isLaterThan\",\"arguments\":{\"timeA\":{\"$variable\":\"event.occurrenceTime\"},\"timeB\":{\"$variable\":\"retrievedLastResolutionEvent.occurrenceTime\"}},\"output\":\"isAfterResolutionTime\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if the current resolution event is \",\"condition\":\" {{ isAfterResolutionTime }} == true\",\"then\":[{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"lastResolutionStateId\"},\"ttl\":{\"$variable\":\"resolutionTtl\"},\"value\":{\"$variable\":\"event\"}}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if the saved alert state has an ope\",\"condition\":\" {{ exists retrievedAlert.state }} and {{ retrievedAlert.state }} == \\"open\\" \",\"then\":[{\"actionId\":\"aiops/alerts/updateFromEvent\",\"arguments\":{\"deduplicationKey\":{\"$variable\":\"event.deduplicationKey\"},\"entity\":{\"$variable\":\"event\"},\"state\":{\"$variable\":\"retrievedAlert\"},\"eventType\":{\"$variable\":\"event.type.eventType\"}},\"output\":\"proposedAlert\"}],\"else\":[{\"actionId\":\"lang/log\",\"arguments\":{\"message\":\"Alert is already clear or closed, so resolution event not processed.\",\"level\":\"INFO\"}}]}}],\"else\":[{\"actionId\":\"lang/log\",\"arguments\":{\"message\":\"Resolution event received before saved last resolution event.\",\"level\":\"INFO\"}}]}}]}}],\"else\":[{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"lastResolutionStateId\"},\"ttl\":{\"$variable\":\"resolutionTtl\"},\"value\":{\"$variable\":\"event\"}}},{\"actionId\":\"aiops/alerts/updateFromEvent\",\"arguments\":{\"deduplicationKey\":{\"$variable\":\"event.deduplicationKey\"},\"entity\":{\"$variable\":\"event\"},\"state\":{\"$variable\":\"retrievedAlert\"},\"eventType\":{\"$variable\":\"event.type.eventType\"}},\"output\":\"proposedAlert\"}]}}]}}],\"else\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":\"create\"},\"output\":\"changeType\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if this is a problem event\",\"condition\":\"{{ event.type.eventType }} == \\"problem\\"\",\"then\":[{\"actionId\":\"aiops/alerts/deriveFromEvent\",\"arguments\":{\"deduplicationKey\":{\"$variable\":\"event.deduplicationKey\"},\"entity\":{\"$variable\":\"event\"},\"eventType\":{\"$variable\":\"event.type.eventType\"}},\"output\":\"proposedAlert\"},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Problem event {{event}} to propose new alert: {{proposedAlert}}\"},\"level\":\"DEBUG\"}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if there is a saved resolution even\",\"condition\":\"{{ exists retrievedLastResolutionEvent }}\",\"then\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if saved resolution event occurrenc\",\"condition\":\"{{ exists retrievedLastResolutionEvent.occurrenceTime }}\",\"then\":[{\"actionId\":\"lang/time/isLaterThan\",\"arguments\":{\"timeA\":{\"$variable\":\"event.occurrenceTime\"},\"timeB\":{\"$variable\":\"retrievedLastResolutionEvent.occurrenceTime\"}},\"output\":\"isAfterResolutionTime\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if the problem event is after the s\",\"condition\":\"{{ isAfterResolutionTime }} == true\",\"then\":[{\"actionId\":\"lang/state/delete\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"lastResolutionStateId\"}}},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Problem event occurred after saved resolution event.\"},\"level\":\"DEBUG\"}}],\"else\":[{\"actionId\":\"aiops/alerts/updateFromEvent\",\"arguments\":{\"deduplicationKey\":{\"$variable\":\"retrievedLastResolutionEvent.deduplicationKey\"},\"entity\":{\"$variable\":\"retrievedLastResolutionEvent\"},\"state\":{\"$variable\":\"proposedAlert\"},\"eventType\":{\"$variable\":\"retrievedLastResolutionEvent.type.eventType\"}},\"output\":\"proposedAlert\"},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Updated proposedAlert: {{proposedAlert}}\"},\"level\":\"DEBUG\"}}]}}]}}]}},{\"actionId\":\"aiops/alerts/generateProposedAlertState\",\"arguments\":{\"entity\":{\"$variable\":\"proposedAlert\"}},\"output\":\"newlyCreatedProposedAlertState\"}],\"else\":[{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Resolution event {{event}} received. No alert in saved state.\"},\"level\":\"DEBUG\"}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if there is a saved resolution even\",\"condition\":\"{{ exists retrievedLastResolutionEvent }}\",\"then\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if saved resolution event occurrenc\",\"condition\":\"{{ exists retrievedLastResolutionEvent.occurrenceTime }}\",\"then\":[{\"actionId\":\"lang/time/isLaterThan\",\"arguments\":{\"timeA\":{\"$variable\":\"event.occurrenceTime\"},\"timeB\":{\"$variable\":\"retrievedLastResolutionEvent.occurrenceTime\"}},\"output\":\"isAfterResolutionTime\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if the current resolution event is \",\"condition\":\"{{ isAfterResolutionTime }} == true\",\"then\":[{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"lastResolutionStateId\"},\"ttl\":{\"$variable\":\"resolutionTtl\"},\"value\":{\"$variable\":\"event\"}}},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Saved resolution state updated with {{event}}.\"},\"level\":\"DEBUG\"}}]}}]}}],\"else\":[{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"lastResolutionStateId\"},\"ttl\":{\"$variable\":\"resolutionTtl\"},\"value\":{\"$variable\":\"event\"}}},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Resolution event {{event}} saved to resolution state.\"},\"level\":\"DEBUG\"}}]}}]}}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if proposedAlert exists do we save \",\"condition\":\" {{ exists proposedAlert }} \",\"then\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"If changeType is create, we save propose\",\"condition\":\" {{ changeType }} == \\"create\\" \",\"then\":[{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"stateId\"},\"ttl\":{\"$variable\":\"alertTtl\"},\"value\":{\"$variable\":\"newlyCreatedProposedAlertState\"}}}],\"else\":[{\"actionId\":\"lang/state/save\",\"arguments\":{\"scope\":\"POLICY\",\"stateId\":{\"$variable\":\"stateId\"},\"ttl\":{\"$variable\":\"alertTtl\"},\"value\":{\"$variable\":\"proposedAlert\"}}}]}},{\"actionId\":\"aiops/io/sendChangeRequest\",\"arguments\":{\"entityId\":{\"$variable\":\"proposedAlert.id\"},\"changeType\":{\"$variable\":\"changeType\"},\"entityType\":\"alert\",\"channel\":\"alerts-input\",\"entity\":{\"$variable\":\"proposedAlert\"}}},{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"$variable\":\"proposedAlert.id\"}},\"output\":\"relatedAlertId\"},{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"id\":{\"$variable\":\"relatedAlertId\"},\"type\":\"aiops.ibm.com/insight-type/event/related-alert\",\"source\":\"aiops/events/event-enrichment\",\"details\":{\"alertId\":{\"$variable\":\"relatedAlertId\"}}}},\"output\":\"event.insights.[]\"}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists event.id }}\",\"then\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"id\":{\"$variable\":\"event.id\"}}},\"output\":\"entityId\"}],\"else\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"id\":{\"$variable\":\"messageKey\"}}},\"output\":\"entityId\"}]}},{\"actionId\":\"lang/log\",\"arguments\":{\"message\":{\"$template\":\"Enriching event {{entityId}}\"},\"level\":\"DEBUG\"}},{\"actionId\":\"aiops/io/sendChangeRequest\",\"arguments\":{\"entityId\":{\"$variable\":\"entityId.id\"},\"changeType\":\"create\",\"entityType\":\"event\",\"channel\":\"updated-events-output\",\"entity\":{\"$variable\":\"event\"}}}]}}]}}]},\"hash\":\"f9c2fe4c4f35efdf681cab07058f3ace38bd94c3\",\"revision\":\"520c15e8d35b6f67c6310a6dad2637767addcec8\",\"hotfields\":null}",
    "entityid": "[\"event\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default alert creation policy\",\"description\":\"Creates and updates alerts from events\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.743Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.743Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/event-received\",\"aiops.ibm.com/trigger/alert-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "393cd9b0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":101,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-pre-update\",\"arguments\":{}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/persistence/persist\",\"arguments\":{\"entity\":{\"$variable\":\"story\"},\"entityId\":{\"$variable\":\"story.id\"},\"entityType\":\"story\",\"changeType\":\"update\",\"channel\":\"stories-output\"}}]},\"hash\":\"837799ea597ea6bf830921d4de713c54f1eeca5a\",\"revision\":\"b4c9eb8547c36fb6a29528a856469a9015621dfb\",\"hotfields\":null}",
    "entityid": "story",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default story-update persistence policy\",\"description\":\"Persists the story update to the data store\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.843Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.843Z\"}",
    "triggerid": "aiops.ibm.com/trigger/story-pre-update"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "393f98d0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":-2,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{\"condition\":\"{{ alert.details.type }} == \\"log\\"\"}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"condition\":\"{{ exists alert.details.metric }}\",\"then\":[{\"actionId\":\"aiops.ibm.com/action/internal/insights/query\",\"arguments\":{\"insightId\":{\"$variable\":\"alert.id\"},\"insightType\":\"aiops.ibm.com/insight-type/log-template\",\"serviceUrl\":{\"$template\":\"{{ services.logAnomalyGoldenSignals.url }}/v2/log_anomaly_golden_signals/get_template_details\"},\"parameters\":{\"template_id\":{\"$variable\":\"alert.details.metric\"},\"app_group_id\":\"1000\",\"app_id\":\"1000\"}},\"output\":\"alert.insights.[]\"},{\"actionId\":\"aiops.ibm.com/action/internal/insights/query\",\"arguments\":{\"insightId\":{\"$variable\":\"alert.id\"},\"insightType\":\"aiops.ibm.com/insight-type/golden-signal\",\"serviceUrl\":{\"$template\":\"{{ services.logAnomalyGoldenSignals.url }}/v2/log_anomaly_golden_signals/get_template_golden_signal\"},\"parameters\":{\"template_id\":{\"$variable\":\"alert.details.metric\"},\"app_group_id\":\"1000\",\"app_id\":\"1000\"}},\"output\":\"alert.insights.[]\"}]}}]},\"hash\":\"aba60feb200f118ccafb161d9ded289ebd36eee0\",\"revision\":\"fe5ff6142d7f058c354e512fec5e0100d0755f3b\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Log anomaly golden signals policy\",\"description\":\"Queries for golden signal details and the log template associated with a log anomaly golden signal metric anomaly, and adds data to the alert as a GoldenSignal insight and LogTemplate insight\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.861Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.861Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "394230e0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":-1,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"event\",\"triggerId\":\"aiops.ibm.com/trigger/event-received\",\"arguments\":{}},\"actions\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"$template\":\"{{ event.resource }}-{{ event.type.classification }}-{{ event.type.condition }}\"}},\"output\":\"event.deduplicationKey\"}]},\"hash\":\"21cbfb1bd4633d21c03bcb46fd361ab72dc31d7c\",\"revision\":\"e3dd7890b864ac81cfd0b9414a458c4fea99241d\",\"hotfields\":null}",
    "entityid": "event",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default event deduplication policy\",\"description\":\"Defines a deduplication key for each event, which is used as part of alert creation\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.877Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.877Z\"}",
    "triggerid": "aiops.ibm.com/trigger/event-received"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "394b7fb0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":101,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":\"{{ exists alert.sender.connectionId }}\"}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/connector/notify\",\"arguments\":{\"entityId\":{\"$variable\":\"alert.id\"},\"entity\":{\"$variable\":\"alert\"},\"prevEntity\":{\"$variable\":\"prevAlert\"},\"connectionId\":{\"$variable\":\"alert.sender.connectionId\"},\"componentName\":\"connector\",\"entityType\":\"alert\",\"changeType\":\"update\",\"channel\":\"connector-alerts\"}}]},\"hash\":\"1c3eded77850f3393498ef10bad10658c988050c\",\"revision\":\"0cbf872eb1ed1af4bdeee733d77a7a52d578f05a\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default alert connector forwarder policy\",\"description\":\"Forwards updates to connector-originated alerts to the relevant connector\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.939Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.939Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-updated"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "394f2930-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":50,\"state\":\"disabled\",\"spec\":{\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\" and {{alert.suppressed}} == false\"}}},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-created\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Match indeterminate severity alerts\",\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ alert.severity }} == 1\"}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":5,\"title\":{\"$variable\":\"alert.summary\"},\"description\":{\"$variable\":\"alert.summary\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":null,\"team\":null}},\"output\":\"global.proposedStories.[]\"}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Match information severity alerts\",\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ alert.severity }} == 2\"}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":4,\"title\":{\"$variable\":\"alert.summary\"},\"description\":{\"$variable\":\"alert.summary\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":null,\"team\":null}},\"output\":\"global.proposedStories.[]\"}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Match warning severity alerts\",\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ alert.severity }} == 3\"}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":3,\"title\":{\"$variable\":\"alert.summary\"},\"description\":{\"$variable\":\"alert.summary\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":null,\"team\":null}},\"output\":\"global.proposedStories.[]\"}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Match minor severity alerts\",\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ alert.severity }} == 4\"}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":2,\"title\":{\"$variable\":\"alert.summary\"},\"description\":{\"$variable\":\"alert.summary\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":null,\"team\":null}},\"output\":\"global.proposedStories.[]\"}]}},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Match major or critical severity alerts\",\"conditions\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{ alert.severity }} >= 5\"}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":1,\"title\":{\"$variable\":\"alert.summary\"},\"description\":{\"$variable\":\"alert.summary\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":null,\"team\":null}},\"output\":\"global.proposedStories.[]\"}]}}]},\"hash\":\"7e4432a3c19aa54376145d6b50c8ce133d3ece81\",\"revision\":\"cbb772289dad3a219d3469c7d4e79185ce93d786\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:createstory\",\"ibm.com/is-default\":\"true\"},\"name\":\"Default story creation policy for all alerts\",\"description\":\"Proposes a story based on any alert\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:24.963Z\",\"creationTimestamp\":\"2023-12-04T10:02:24.963Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-created"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "3959fea0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":102,\"state\":\"enabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-update\",\"arguments\":{}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/persistence/persist\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"entityId\":{\"$variable\":\"alert.id\"},\"entityType\":\"alert\",\"changeType\":\"update\",\"channel\":\"alerts-output\"}}]},\"hash\":\"88be628b3e6ceaa7c9e0f4875cb26b63193323b4\",\"revision\":\"edf34735744d52d3629db1bd969f070f7661f10c\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default alert-update persistence policy\",\"description\":\"Persists updates to alerts to the data store\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:25.033Z\",\"creationTimestamp\":\"2023-12-04T10:02:25.033Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-pre-update"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "395c6fa0-928c-11ee-98c1-1f552bbe125f",
    "configuration": "{\"executionPriority\":50,\"state\":\"disabled\",\"spec\":{\"constants\":{},\"trigger\":{\"entityId\":\"story\",\"triggerId\":\"aiops.ibm.com/trigger/story-pre-create\",\"arguments\":{}},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/insights/query\",\"arguments\":{\"insightType\":\"aiops.ibm.com/insight-type/similar-incidents\",\"serviceUrl\":{\"$template\":\"{{ services.similarIncidents.url }}/v2/similar_incidents/search\"},\"insightId\":{\"$variable\":\"story.id\"},\"parameters\":{\"story_id\":{\"$variable\":\"story.id\"},\"text\":{\"$variable\":\"story.title\"},\"application_group_id\":\"1000\",\"application_id\":\"1000\"}},\"output\":\"proposedInsight\"},{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Only if we have a valid insight\",\"condition\":\"{{ exists proposedInsight }}\",\"then\":[{\"actionId\":\"lang/eval\",\"arguments\":{\"input\":{\"$variable\":\"proposedInsight\"}},\"output\":\"story.insights.[]\"}]}}]},\"hash\":\"bcced5a6c835f66c4499dbcb0854cef0bdb5d2bd\",\"revision\":\"dc9d19ac69d70545b56299b7629f2d346e3d5c7f\",\"hotfields\":null}",
    "entityid": "story",
    "metadata": "{\"labels\":{\"ibm.com/is-default\":\"true\"},\"name\":\"Default story query similar incidents service policy\",\"description\":\"Queries the similar incidents service for ticket resolutions that match the incident title and enriches this information into the story\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T10:02:25.050Z\",\"creationTimestamp\":\"2023-12-04T10:02:25.050Z\"}",
    "triggerid": "aiops.ibm.com/trigger/story-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "5a2dbfa0-92a9-11ee-ad23-03bc06d9e1ae",
    "configuration": "{\"executionPriority\":50,\"state\":\"enabled\",\"spec\":{\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\"},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/conditional\",\"arguments\":{\"name\":\"\",\"condition\":\"({{contains alert.resource.name \\"mysql\\"}})\",\"then\":[{\"actionId\":\"aiops.ibm.com/action/internal/runbooks/add\",\"output\":\"alert.insights.[]\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"runbookId\":\"b0d0ff2f-6de1-4c4c-a2e2-5b9170aaef15\",\"isAutomated\":false,\"mappings\":[{\"mappingType\":\"useDefault\",\"parameterValue\":\"\",\"runbookParameterName\":\"clusterCredentials\"}]}}]}}]},\"hash\":\"cd36ed4f837284933b956c3734d600b2b8917b29\",\"revision\":\"4c2f9163f971c4d5f1c1a41a54c08b0aaa8173e5\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:assignrunbook\",\"ibm.com/is-default\":\"false\"},\"name\":\"DEMO RobotShop Mitigation\",\"description\":\"Created by Nicks scripts\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T13:30:55.513Z\",\"creationTimestamp\":\"2023-12-04T13:30:55.513Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "5c856b40-92a9-11ee-ad23-03bc06d9e1ae",
    "configuration": "{\"executionPriority\":50,\"state\":\"enabled\",\"spec\":{\"trigger\":{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\"},\"actions\":[{\"actionId\":\"aiops.ibm.com/action/internal/conditional\",\"arguments\":{\"name\":\"\",\"condition\":\"({{contains alert.resource.name \\"catalogue-db\\"}})\",\"then\":[{\"actionId\":\"aiops.ibm.com/action/internal/runbooks/add\",\"output\":\"alert.insights.[]\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"runbookId\":\"a1b452d7-7ccc-4c9c-a2f0-4f4e036e04e1\",\"isAutomated\":true,\"mappings\":[{\"mappingType\":\"useDefault\",\"parameterValue\":\"\",\"runbookParameterName\":\"clusterCredentials\"}]}}]}}]},\"hash\":\"d2abbac5a289876fe03739a15ade18986261c7bc\",\"revision\":\"b9a09fbb7e977adf47589281ba4ebae194e20d77\",\"hotfields\":[]}",
    "entityid": "alert",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:assignrunbook\",\"ibm.com/is-default\":\"false\"},\"name\":\"DEMO SockShop Mitigation\",\"description\":\"Created by Nicks scripts\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T13:30:59.444Z\",\"creationTimestamp\":\"2023-12-04T13:30:59.444Z\"}",
    "triggerid": "aiops.ibm.com/trigger/alert-pre-create"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "d64d5a00-9295-11ee-ad23-03bc06d9e1ae",
    "configuration": "{\"executionPriority\":10,\"state\":\"enabled\",\"spec\":{\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-created\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"$variable\":\"constants.baseTriggerCondition\"},{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{prevAlert.suppressed}} != {{alert.suppressed}} or {{prevAlert.lastOccurrenceTime}} != {{alert.lastOccurrenceTime}}\"}}]}}}}],\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\" and {{alert.suppressed}} == false\"}}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Condition set 1\",\"conditions\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"({{alert.sender.service}} == \\"DemoTube\\") and ({{alert.type.classification}} == \\"No service\\") and ({{alert.severity}} == 6)\"}}]}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":1,\"retentionDays\":30,\"title\":{\"$template\":\"{{ alert.summary }}\"},\"description\":{\"$template\":\"{{ alert.summary }}\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":\"demo\",\"team\":\"All users\"},\"addRelatedAlerts\":{\"update\":false}},\"output\":\"global.proposedStories.[]\"}]}}]},\"hash\":\"34a224659432b6ff4e7aaae712d2015bbf80d4b3\",\"revision\":\"2f3b369100ac4359f571239195e7f035692ea51a\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:createstory\",\"ibm.com/is-default\":\"false\"},\"name\":\"DEMO London-Underground - No service\",\"description\":\"Created by Nicks scripts\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T11:11:13.822Z\",\"creationTimestamp\":\"2023-12-04T11:11:13.822Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-created\",\"aiops.ibm.com/trigger/alert-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "d678d6d0-9295-11ee-ad23-03bc06d9e1ae",
    "configuration": "{\"executionPriority\":40,\"state\":\"enabled\",\"spec\":{\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-created\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}}],\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\" and {{alert.suppressed}} == false\"}}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Condition set 1\",\"conditions\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"({{alert.sender.service}} == \\"DemoTube\\") and ({{alert.type.classification}} == \\"Severe delays\\") and ({{alert.severity}} >= 4)\"}}]}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":4,\"retentionDays\":30,\"title\":{\"$template\":\"{{ alert.summary }}\"},\"description\":{\"$template\":\"{{ alert.summary }}\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":\"demo\",\"team\":\"All users\"},\"addRelatedAlerts\":{\"update\":false}},\"output\":\"global.proposedStories.[]\"}]}}]},\"hash\":\"5d74ad2bc691ea07234352dd5b65526380b3a936\",\"revision\":\"6a8b7e6b2349543d3d69908a5c328f437261918b\",\"hotfields\":[]}",
    "entityid": "[\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:createstory\",\"ibm.com/is-default\":\"false\"},\"name\":\"DEMO London-Underground - Severe delays\",\"description\":\"Created by Nicks scripts\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T11:11:14.109Z\",\"creationTimestamp\":\"2023-12-04T11:11:14.109Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-created\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "d69845b0-9295-11ee-ad23-03bc06d9e1ae",
    "configuration": "{\"executionPriority\":90,\"state\":\"enabled\",\"spec\":{\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-created\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}}],\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\" and {{alert.suppressed}} == false\"}}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Condition set 1\",\"conditions\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"({{alert.sender.service}} == \\"DemoTube\\") and ({{alert.severity}} <= 3)\"}}]}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":2,\"retentionDays\":30,\"title\":{\"$template\":\"{{ alert.summary }}\"},\"description\":{\"$template\":\"{{ alert.summary }}\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}}],\"assignment\":{\"owner\":\"demo\",\"team\":\"All users\"},\"addRelatedAlerts\":{\"update\":false}},\"output\":\"global.proposedStories.[]\"}]}}]},\"hash\":\"85457b713b457ca40e22e93c13b07a1ed92e7609\",\"revision\":\"d8621e9fe3664d5ce1a3ffe5f99252975e238457\",\"hotfields\":[]}",
    "entityid": "[\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:createstory\",\"ibm.com/is-default\":\"false\"},\"name\":\"DEMO London-Underground - Catch All\",\"description\":\"Created by Nicks scripts\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T11:11:14.314Z\",\"creationTimestamp\":\"2023-12-04T11:11:14.314Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-created\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "d6c57030-9295-11ee-ad23-03bc06d9e1ae",
    "configuration": "{\"executionPriority\":50,\"state\":\"enabled\",\"spec\":{\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-pre-create\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"$variable\":\"constants.baseTriggerCondition\"},{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{prevAlert.lastOccurrenceTime}} != {{alert.lastOccurrenceTime}}\"}}]}}}}],\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\"\"}}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Condition set 1\",\"conditions\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"({{alert.sender.service}} == \\"DemoTube\\")\"}}]}},\"then\":[{\"actionId\":\"aiops.ibm.com/action/internal/insights/correlate\",\"output\":\"alert.insights.[]\",\"arguments\":{\"correlationKey\":{\"$template\":\"{{alert.sender.service}}\"},\"relationshipType\":\"aiops.ibm.com/insight-type/relationship/causal\",\"relationshipSource\":\"aiops.ibm.com/insight-source/relationship/causal/custom\",\"relationshipDetails\":{\"policyId\":{\"$variable\":\"policy.id\"}},\"window\":{\"durationMS\":10000,\"type\":\"rolling\"}}}]}}]},\"hash\":\"30eeae3a94d445b3f548e538719b88f2a6a23690\",\"revision\":\"72c12a11e461d14d6d8937f7a96078319fc0fc2a\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\"]",
    "metadata": "{\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:scopebased\",\"ibm.com/is-default\":\"false\"},\"name\":\"DEMO London-Underground - Scope Grouping\",\"description\":\"Created by Nicks scripts\",\"createdBy\":{\"id\":\"system\",\"type\":\"system\"},\"lastUpdatedBy\":{\"id\":\"system\",\"type\":\"system\",\"changeDetails\":\"Created\"},\"lastUpdatedTimestamp\":\"2023-12-04T11:11:14.610Z\",\"creationTimestamp\":\"2023-12-04T11:11:14.610Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-pre-create\",\"aiops.ibm.com/trigger/alert-updated\"]"
  },
  {
    "tenantid": "cfd95b7e-3bc7-4006-a4a8-a73a79c71255",
    "policyid": "e8a17dd0-92a9-11ee-ad23-03bc06d9e1ae",
    "configuration": "{\"executionPriority\":50,\"state\":\"enabled\",\"spec\":{\"triggers\":[{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-created\",\"arguments\":{\"condition\":{\"$variable\":\"constants.baseTriggerCondition\"}}},{\"entityId\":\"alert\",\"triggerId\":\"aiops.ibm.com/trigger/alert-updated\",\"arguments\":{\"condition\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"$variable\":\"constants.baseTriggerCondition\"},{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{prevAlert.suppressed}} != {{alert.suppressed}} or {{prevAlert.eventCount}} != {{alert.eventCount}}\"}}]}}}}],\"constants\":{\"baseTriggerCondition\":{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"{{alert.state}} != \\"clear\\" and {{alert.state}} != \\"closed\\" and {{alert.suppressed}} == false\"}}},\"actions\":[{\"actionId\":\"lang/if\",\"arguments\":{\"name\":\"Condition set 1\",\"conditions\":{\"actionId\":\"lang/condition/and\",\"arguments\":{\"conditions\":[{\"actionId\":\"lang/condition/template\",\"arguments\":{\"template\":\"({{alert.severity}} >= 2)\"}}]}},\"then\":[{\"actionId\":\"aiops/stories/deriveFromAlert\",\"arguments\":{\"entity\":{\"$variable\":\"alert\"},\"priority\":1,\"retentionDays\":30,\"title\":{\"$template\":\"{{ alert.summary }}\"},\"description\":{\"$template\":\"{{ alert.summary }}\"},\"holdoffSec\":0,\"notification\":[{\"type\":\"snow\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"chatops\",\"name\":\"AIOPSSystemDefault\",\"details\":{}},{\"type\":\"connector\",\"details\":{\"name\":\"email\",\"displayName\":\"email\",\"connectorUID\":\"d4faee54-efec-4d74-af54-07ffcecb1e82\",\"connectionType\":\"email-notifications\",\"status\":\"Running\"}}],\"assignment\":{\"owner\":\"demo\",\"team\":\"All users\"},\"addRelatedAlerts\":{\"update\":false}},\"output\":\"global.proposedStories.[]\"}]}}]},\"hash\":\"f4b3d427d8b053d647f2a3defc87c8170b3a473f\",\"revision\":\"7e891b3cb9f9802dc61462708d302ded949d2b0f\",\"hotfields\":[]}",
    "entityid": "[\"alert\",\"alert\"]",
    "metadata": "{\"lastUpdatedBy\":{\"changeDetails\":\"Created\",\"id\":\"demo\",\"type\":\"user\"},\"labels\":{\"ibm.com/aiops/uitemplate\":\"alert:createstory\",\"ibm.com/is-default\":\"false\"},\"name\":\"test\",\"description\":\"test\",\"lastUpdatedTimestamp\":\"2023-12-04T13:34:54.508Z\",\"createdBy\":{\"id\":\"demo\",\"type\":\"user\"},\"creationTimestamp\":\"2023-12-04T13:34:54.508Z\"}",
    "triggerid": "[\"aiops.ibm.com/trigger/alert-created\",\"aiops.ibm.com/trigger/alert-updated\"]"
  }
]
